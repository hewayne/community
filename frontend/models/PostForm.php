<?php/** * Created by PhpStorm. * User: wayne * Date: 2016/12/23 * Time: 21:16 */namespace frontend\models;use common\models\Post;use common\models\User;use yii\base\Model;use yii\data\Pagination;class PostForm extends Model {    public $title;    public $content;    public $imgs;    public $id;    public function rules()    {        return [            [['title', 'content'], 'required'],            [['title'], 'string', 'max' => 32],            [['content'], 'string', 'max' => 1000],            [['imgs'], 'string', 'max' => 255],        ];    }    //保存提交的帖子数据    public function savePost(){        $model = new Post();        $model->setAttributes($this->attributes);        $model->user_id = (int)\Yii::$app->user->id;        $model->create_time = time();        if (!$model->save()){            return false;        }        //将用户的帖子数加1，积分加50        $userModel = User::findOne(\Yii::$app->user->id);        $userModel->updateCounters(['post_num' => 1, 'point' => 50]);        $this->id = $model->id;  //将$model的id赋给postForm的id，以便传递给前台执行页面跳转        return true;    }    public function getUserPost($userId){        $query = Post::find()->select(['id', 'title', 'create_time'])->where(['user_id' => $userId]);        $pagination = new Pagination([            'defaultPageSize' => 8,            'totalCount' => $query->count(),        ]);        $posts = $query->orderBy(['id' => SORT_DESC])            ->offset($pagination->offset)            ->limit($pagination->limit)->asArray()->all();        return ['posts' => $posts, 'pagination' => $pagination];    }}