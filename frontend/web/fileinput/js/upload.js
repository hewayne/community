/*上传用户填写的club信息(ajax)*/var imgUrl = '';var fileObj = $('#file');var title;var content;$('.btn-send').click(function () {  //当点击发送按钮时（不是文件上传自带的"上传"按钮）    title = $('#title_input').val();    content = $('#content').val();    if (title != '' && content != ''){        if ($('.file-preview-image').length > 0){            $('.fileinput-upload-button').click();  //如果选择了图片，就执行图片上传，并返回了imgUrl        }else {            save(); //如果没有选择图片，就直接提交表单        }    }else {        var alertOptions = {            message: '<h3>&nbsp;&nbsp;&nbsp;标题、内容不能为空！</h3>',            title: '提示信息：',            size: 'lg',            useBin: false        };        eModal.alert(alertOptions);    }});fileObj.fileinput({    uploadUrl: 'index.php?r=club/upload', // you must set a valid URL here else you will get an error    allowedFileExtensions : ['jpg', 'png','gif'],    overwriteInitial: false,    showUpload: true,    uploadAsync: false,    maxFileSize: 2000,    maxFileCount: 3,    language: 'zh',    resizeImage: true,    maxImageWidth: 300,    maxImageHeight: 300,    resizePreference: 'width',    allowedFileTypes: ['image'],    slugCallback: function(filename) {        return filename.replace('(', '_').replace(']', '_');    }});fileObj.on('filebatchuploadsuccess', function(event, data, previewId, index) {    imgUrl = data.response['response'];     //获取已经上传后的图片url（从后台返回的json数据)    save(); //提交title、content、imgs    //alert(imgUrl);    //$('#show-json').text(JSON.stringify(data));    //alert(data.response['response']);    //$('#show-json').append('<img src="'+ data.response['response'] +'">');    //alert(imgPath);    //window.location.href = 'index.php?r=club/detail';});function save() {     $.ajax({         url: 'index.php?r=club/edit',         method: 'POST',         data: {title : title, content: content, imgs: imgUrl},     //这里填写了图片上传的地址         dataType: 'json',         success: function (data) {             if (data['static'] == 1){                 //alert('上传成功: ' + data['id']);                 window.location.href = 'index.php?r=club/detail&id=' + data['id'] + '&comefrom=edit';             }else {                 var alertOptions = {                     message: '<h3>&nbsp;&nbsp;&nbsp;发送失败！</h3><br>' +                     '<h2 style="text-align: center">状态码： '+ data["static"] +'</h2>',                     title: '提示信息：',                     size: 'lg',                     useBin: false                 };                 eModal.alert(alertOptions);             }         }     });}