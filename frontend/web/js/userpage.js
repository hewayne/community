/** * Created by wayne on 2016/12/31. *//*私信编辑与发送*/function leaveMessage() {    if (checkLogin()){        var options = {            message: "你想对他/她说什么？",            title: '私信',            size: eModal.size.lg        };        eModal.prompt(options)            .then(function () {                var letter = $('.modal-tmp').find('input').val();                var toUser = $('.username').text();                $.ajax({                    url: 'index.php?r=user/letter',                    method: 'post',                    dataType: 'json',                    data: {letter: letter, toUser: toUser},                    success: function (res) {                        if (res['static'] == 0){                            setTimeout(function () {                                alertMessage('发送失败！', '0');                            }, 500);  //此处立即弹出会有bug,所以使用了延时                        }else {                            setTimeout(function () {                                alertMessage('发送成功！', '1');                            }, 500);  //此处立即弹出会有bug,所以使用了延时                        }                    }                });            }, function () {});    }}/*个人主页--一句话介绍*/$('.intro-edit-btn').click(function () {    var introObj = $('.intro');    var intro = introObj.text();    introObj.remove();    $('.intro-box').after('<textarea id="edit-intro" class="form-control" rows="2" maxlength="255">' + intro + '</textarea>' +        '<button class="btn btn-default btn-xs intro-send-btn" onclick="sendIntro()" style="margin-top: 10px; float: right;"><i class="glyphicon glyphicon-send"></i>&nbsp;发送</button>' +        '<div class="clearfix"></div>');});function sendIntro() {    $.ajax({        url: 'index.php?r=user/edit-intro',        method: 'post',        dataType: 'json',        data: {intro: document.getElementById('edit-intro').value},        success: function (res) {            if (res['static'] == 1){                alertMessage('发送成功', '1');                setTimeout(function () {                    location.href = 'index.php?r=user/userpage&userid=' + $('.username').attr('userid');                },2000);            }else {                alertMessage('发送失败！', '0');            }        }    });}$('.avatar-select-box > img').click(function () {    $.ajax({        url: 'index.php?r=user/select-avatar',        method: 'post',        dataType: 'json',        data: {avatar: $(this).attr('src')},        success: function (res) {            if (res['status'] == 1){                alertMessage('选择成功！', 1);                setTimeout(function () {                    history.go(-1);                }, 2000);            }else {                alertMessage('选择失败！', 0);            }        }    });});/*--------------------------------公共方法(begin)-----------------------------------*///获取指定的cookie的值function getCookie(c_name){    if (document.cookie.length>0)    {        c_start=document.cookie.indexOf(c_name + "=");        if (c_start!=-1)        {            c_start=c_start + c_name.length+1;            c_end=document.cookie.indexOf(";",c_start);            if (c_end==-1) c_end=document.cookie.length;            return unescape(document.cookie.substring(c_start,c_end));        }    }    return ""}//判断是否登录,如果未登录则弹出提示框，否则返回truefunction checkLogin() {    if (!getCookie('isLogin')){        alertLoginModal();    }else {        return true;    }}//显示未登录的提示框function alertLoginModal() {    var alertOptions = {        message: '<h3>你还未登录•••</h3><br>' +        '<div class="f-right"><a class="btn btn-info btn-sm" href="index.php?r=site/login">登录</a>' +        '&nbsp;&nbsp;&nbsp;&nbsp;或&nbsp;&nbsp;&nbsp;&nbsp;' +        '<a class="btn btn-info btn-sm" href="index.php?r=site/signup">注册</a></div>',        title: '提示信息：',        size: 'lg',        useBin: false    };    eModal.alert(alertOptions);}function alertMessage(message, status) {    var color = '#db8e01';    if (status == 1){        color = '#00aa00';    }else {        color = '#db8e01';    }    var alertOptions = {        message: '<h3 style="color: ' + color + '">' + message + '</h3><br>',        title: '提示信息：',        size: 'lg',        useBin: false    };    eModal.alert(alertOptions);}